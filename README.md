# snp_pipeline

**Licence:	GNU General Public License v3.0 (copy provided in directory)**<br />
Author:		Tom van Wijk<br />
Contact:	tom_van_wijk@hotmail.com<br />

### DESCRIPTION

Pipeline to perform SNP calling on raw sequence data.
Currently only supports illumina paired-end read data and
supplied with a Salmonella Dublin reference genome.

### REQUIREMENTS

-	Linux operating system. This software is developed on Linux Ubuntu 16.04<br />
	**Experiences when using different operating systems may vary.**
-	python 2.7.x
-	python libraries as listed in the import section of mothur_amplicon_pipeline.py
-	erne v2.1.1 or newer
-	Burrows-Wheels Aligner v0.7.12 or newer
-	Samtools v0.1.19 or newer
-   Picard Tools v2.18.7 or newer
-   VarScan 2.3.9 or newer


### INSTALLATION

-	Clone the SNP_pipeline repository to the desired location on your system.<br />
	`git clone https://github.com/tom-van-wijk/SNP_pipeline.git`
-	Add the location of the SNP_pipeline directory to the PATH variable:<br />
	`export PATH=$PATH:/path/to/SNP_pipeline`<br />
	(It is recommended to add this command to your ~/.bashrc file)
-	Create path variable SNP_REF to the SNP_pipeline directory:<br />
	`export SNP_REF=/path/to/SNP_pipeline`<br />
	(It is recommended to add this command to your ~/.bashrc file)
-	Create path variable PICARD to picard.jar:<br />
	`export PICARD=/path/to/picard.jar`<br />
	(It is recommended to add this command to your ~/.bashrc file)
-	Create path variable VARSCAN to VarScan.vX.X.X.jar:<br />
	`export VARSCAN=/path/to/VarScan.vX.X.X.jar`<br />
	(It is recommended to add this command to your ~/.bashrc file)

### USAGE

Start the pipeline with the following command:

`snp_pipeline.py -i 'inputdir' -o 'outputdir' -t 'threads'
-x 'savetemp' -r 'reference'`

-	**'inputdir':**	location of input directory. (required)<br />
			Should only contain either the uncompressed (.fastq)
			or compressed (.fastq.gz) sequence files containing the
			raw sequences of the forward and reverse reads.
			For each sample, these fastq files need to be named with
			an '_R1' or '_R2' tag respectively and  be furthermore identical.
			The data is expected to be free of primer-, barcode- and adapter sequences.
			Quality trimming is performed by the pipeline.			

-	**'outputdir':**	location of output directory.<br />
			Default = subdirectory in inputdir

-	**'threads':**	Number of threads (virtual cpu cores) to be used.<br />
			Default = 8.

-	**'savetemp':**	Set to true so save the temporary files and
			directories generated by the pipeline.<br />
			default = false
            
-	**'reference':** Set the reference genome to be used for creating alignments
            and calling SNP's.<br />
			default = NC_011205. (Salmonella Dublin)

### ADDING NEW REFERENCE GENOMES

It is possible to add your own reference genomes by adding the genomes to
the reference_file directory in .fasta format and run the following commands:<br />
-   Index the reference genomes using BWA:<br />
    `bwa index 'genome'.fasta`<br />
-   Create dictionary file of database for PICARD:<br />
    `samtools faidx 'genome'.fasta`<br />
-   Add 'genome'.cvs containing gene annotations, these are used for filtering snp's in the accessory genome.<br />

You can now run the pipeline with de -r 'genome' parameter where 'genome'
is the name of the reference files (without extension).
